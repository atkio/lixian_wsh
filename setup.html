<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>
        </title>
         <link rel="stylesheet" href="jquery/jquery.mobile-1.1.1.min.css" />
        <link rel="stylesheet" href="my.css" />
        <style>
            /* App custom styles */
        </style>
        <script src="jquery/jquery.min.js">
        </script>
        <script src="jquery/jquery.mobile-1.1.1.min.js">
        </script>
        <script src="my.js">
        </script>
    </head>
    <body>
        <!-- Home -->
        <div data-role="page" id="page1">
            <div data-theme="a" data-role="header">
                <a data-role="button" data-rel="back" href="#page1" data-icon="back" data-iconpos="left" class="ui-btn-right">
                    BACK
                </a>
                <h3>
                    环境设置
                </h3>
                <a data-role="button" href="#page1" data-icon="home" data-iconpos="left" class="ui-btn-left">
                    HOME
                </a>
            </div>
            <div data-role="content">
                <div data-role="fieldcontain">
                    <fieldset data-role="controlgroup">
                        <label for="LIXIAN_DOWNLOAD_PATH">
                            下载路径
                        </label>
                        <input nam  e="LIXIAN_DOWNLOAD_PATH" id="LIXIAN_DOWNLOAD_PATH" placeholder="" value="" type="text" />
                    </fieldset>
                </div>
                <div data-role="collapsible-set" data-theme="b" data-content-theme="e">
                    <div data-role="collapsible" data-collapsed="false">
                        <h3>
                            特殊设置
                        </h3>
                        <div data-role="fieldcontain">
                            <fieldset data-role="controlgroup">
                                <label for="pretask">
                                    下载前脚本(未来)
                                </label>
                                <input name="pretask" id="pretask" placeholder="" value="" type="text" />
                            </fieldset>
                        </div>
                        <div data-role="fieldcontain">
                            <fieldset data-role="controlgroup">
                                <label for="aftertask">
                                    下载完成后脚本(未来)
                                </label>
                                <input name="aftertask" id="aftertask" placeholder="" value="" type="text" />
                            </fieldset>
                        </div>
                    </div>
                </div>
                <Button data-role="button" data-theme="b" onclick="postme()">
                    修改
                </Button>
            </div>
        <script>
            $('#LIXIAN_DOWNLOAD_PATH')[0].value = $.config.LIXIAN_DOWNLOAD_PATH;
			$('#pretask')[0].value = $.config.pretask;
			$('#aftertask')[0].value = $.config.aftertask;
			
			function postme()
			{
				$.ajax({
					type: "POST",
					data: {aftertask:$('#aftertask')[0].value,
						   pretask:$('#pretask')[0].value,
						   LIXIAN_DOWNLOAD_PATH:$('#LIXIAN_DOWNLOAD_PATH')[0].value},
					url: "cgi-bin/saveconfig.py",
					success: function(msg){	
					jQuery.getJSON("cgi-bin/loadconfig.py", function(data){
						 $.config=data;	
						 $('#LIXIAN_DOWNLOAD_PATH')[0].value = $.config.LIXIAN_DOWNLOAD_PATH;
						$('#pretask')[0].value = $.config.pretask;
						$('#aftertask')[0].value = $.config.aftertask;
						});
					}
				});
			}			
        </script>
		</div>
    </body>
</html>
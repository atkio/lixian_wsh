(function(b){function a(){var e,f,d,h,c=this,g=b.mobile.activePage;this.init=function(i,j){e=b.extend({content:"",popupId:"popup"+g.attr("id"),closeBtnLabel:"Okay",history:false},i);f=b.extend({positionTo:"window"},j);if(typeof i==="string"){e.content=i}c.setPopupWrappers();c.popupatePopupContent();c.putPopupInDOM();c.openPopup();return h};this.setPopupWrappers=function(){h=b("#"+e.popupId);if(h.length==0){d={main:b("<div></div>").attr({id:e.popupId}),content:b("<div></div>").attr({"data-role":"content"}).addClass("ui-content content"),closeX:b("<a></a>").attr({href:"#","data-role":"button","data-rel":"back","data-icon":"delete","data-iconpos":"notext","data-theme":"b"}).addClass("ui-btn-right closeX").html("Close").button(),closeBtn:b("<a></a>").attr({href:"#","data-inline":true,"data-rel":"back","data-icon":"check","data-iconpos":"right","data-theme":"b"}).addClass("closeBtn").html(e.closeBtnLabel).button()}}else{d={main:h,content:h.find(".content"),closeX:h.find(".closeX"),closeBtn:h.find(".closeBtn")}}};this.popupatePopupContent=function(){if(typeof e.content==="string"){d.content.html(e.content)}if(e.content instanceof jQuery){d.content.html(e.content.html())}};this.putPopupInDOM=function(){h.remove();d.main.append(d.closeX);d.main.append(d.content).append(d.closeBtn);g.append(d.main)};this.openPopup=function(){h=b("#"+e.popupId);h.popup(e);h.popup("open",f)}}b.dynamic_popup=function(d,e){var c=new a();return c.init(d,e)}})(jQuery);